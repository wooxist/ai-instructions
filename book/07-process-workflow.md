# 7장. 기본 워크플로우 패턴과 처리

에이전트가 단독으로 작업을 수행하는 것을 넘어, 여러 에이전트가 협력하여 더 복잡한 문제를 해결하는 방법을 알아봅니다. 이번 장에서는 가장 기본적이면서도 강력한 두 가지 협업 워크플로우인 '파이프라인(Pipeline)'과 '생성-검증(Generate-and-Verify)' 패턴을 소개합니다. 또한, 이러한 워크플로우를 코드가 아닌 설정 파일로 정의하고 관리하는 방법을 배웁니다.

## 7.1 파이프라인(Pipeline) 패턴

파이프라인은 가장 직관적인 협업 방식으로, 여러 에이전트가 작업을 순차적으로 처리하는 모델입니다. 마치 공장의 컨베이어 벨트처럼, 한 에이전트의 작업 결과(output)가 다음 에이전트의 입력(input)으로 전달됩니다.

이 패턴은 다음과 같은 단계로 구성된 작업에 매우 효과적입니다.

1.  **데이터 수집 에이전트**: 웹이나 문서에서 정보를 수집합니다.
2.  **데이터 정제 에이전트**: 수집된 정보에서 불필요한 부분을 제거하고 형식을 표준화합니다.
3.  **핵심 정보 추출 에이전트**: 정제된 데이터에서 핵심 내용을 요약하거나 특정 정보를 추출합니다.
4.  **보고서 생성 에이전트**: 추출된 정보를 바탕으로 최종 보고서를 작성합니다.

각 에이전트는 자신의 역할에만 집중하므로, 전체 프로세스의 효율성과 명확성이 높아집니다.

## 7.2 생성-검증(Generate-and-Verify) 패턴

'생성-검증' 패턴은 한 에이전트가 결과물을 만들면(Generate), 다른 에이전트가 그 결과물을 검증하고 피드백을 주는(Verify) 협업 모델입니다. 이 패턴은 결과물의 품질을 높이는 데 매우 중요한 역할을 하며, '피드백 루프(Feedback Loop)'를 만드는 가장 기본적인 방법입니다.

예를 들어, 다음과 같은 시나리오에 적용할 수 있습니다.

*   **콘텐츠 생성**: '작가 에이전트'가 블로그 포스트 초안을 작성하면, '편집자 에이전트'가 문법 오류나 어색한 표현을 찾아 수정 제안을 합니다.
*   **코드 리뷰**: '개발자 에이전트'가 새로운 기능에 대한 코드를 작성하면, '리뷰어 에이전트'가 코드의 버그 가능성이나 스타일 가이드 위반 여부를 검토하고 개선점을 제안합니다.

이 패턴은 한 번에 끝나지 않고, 검증 에이전트의 피드백을 바탕으로 생성 에이전트가 결과물을 수정하고 다시 검증받는 과정을 여러 번 반복할 수 있습니다.

## 7.3 워크플로우 정의 (`workflow.yaml`)

워크플로우가 복잡해질수록, 각 단계를 코드에 직접 하드코딩하는 것은 비효율적이고 유지보수가 어렵습니다. 대신, 워크플로우의 구조와 각 단계에서 실행될 에이전트를 별도의 설정 파일로 정의하는 것이 좋습니다.

`YAML`이나 `JSON` 형식의 설정 파일을 사용하면, 코드 수정 없이 워크플로우의 순서를 바꾸거나 새로운 단계를 추가하는 등 유연한 변경이 가능합니다.

다음은 `workflow.yaml` 파일에 파이프라인 패턴을 정의한 간단한 예시입니다.

```yaml
name: "콘텐츠 생성 파이프라인"
workflow:
  - agent: "리서치 에이전트"
    prompt: "AI 에이전트 협업의 최신 동향을 조사해줘."
    output: "research_result.txt"

  - agent: "초안 작성 에이전트"
    prompt: "research_result.txt 파일을 기반으로 블로그 포스트 초안을 작성해줘."
    input: "research_result.txt"
    output: "draft.md"

  - agent: "검수 에이전트"
    prompt: "draft.md 파일의 문법과 사실 관계를 확인하고, 개선점을 제안해줘."
    input: "draft.md"
```

이처럼 워크플로우를 코드가 아닌 데이터로 정의함으로써, 전체 시스템의 유연성과 확장성을 크게 높일 수 있습니다.

---

이번 장에서 다룬 기본 워크플로우 패턴들은 앞으로 배울 더 복잡하고 정교한 협업 아키텍처의 기초가 됩니다. 다음 장에서는 에이전트의 성능을 측정하고 최적화하는 방법을 알아보겠습니다.