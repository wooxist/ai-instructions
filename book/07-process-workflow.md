# 7장. 처리 방법과 워크플로우 설계

**1부: 인스트럭션의 기초와 설계 원칙**

**목적:** 여러 에이전트가 협력하여 복잡한 작업을 해결하는 '일하는 방식'을 설계한다.

### 이 장에서 배우는 것
- 단일 작업을 작은 단계로 나누어 지시하는 방법(Step-wise)
- 여러 에이전트를 조합하여 만드는 워크플로우의 기본 패턴
- 에이전트 간 데이터를 안정적으로 주고받는 핸드오프(Handoff) 설계 방법
- 워크플로우 실패 시 대응 및 재시도 전략 수립하기

## 7.1 단일 작업 처리 방법(Step-wise) 설계
복잡한 작업은 작은 단계로 나누어 순서대로 지시합니다. 각 단계마다 산출물과 성공 기준을 명시하여 실행과 검증을 쉽게 만듭니다. 이는 [3장](03-good-instructions.md)의 단계성 원칙을 심화하는 과정입니다.

## 7.2 멀티 에이전트 워크플로우 설계
워크플로우는 단일 에이전트로는 해결하기 어려운 복잡한 문제를 여러 전문 에이전트의 협력으로 해결하는 '프로세스'입니다. 각 에이전트는 특정 역할을 맡고, 이들의 작업이 모여 하나의 큰 결과물을 만들어냅니다.

- **에이전트(Agent):** 특정 역할(예: 생성, 검증, 요약)을 수행하는 주체입니다. [5장. 역할(Agent)과 제약(Constraint) 설계](05-agent-constraints.md)에서 정의한 페르소나를 기반으로 합니다.
- **도구(Tool):** 에이전트가 사용하는 기능입니다. (예: 웹 검색, 데이터베이스 조회, 코드 실행기)
- **트리거(Trigger):** 워크플로우를 시작시키는 이벤트입니다. (예: 특정 시간, 파일 업로드, API 호출)

### 에이전트 간 핸드오프(Handoff) 설계
핸드오프는 한 에이전트의 작업 결과를 다음 에이전트에게 안정적으로 전달하는 약속(인터페이스)입니다. 워크플로우의 성공은 이 핸드오프 설계에 달려있습니다.

- **데이터 형식 표준화:** JSON 스키마 등을 사용하여 에이전트 간에 주고받을 데이터의 구조를 명확히 정의합니다.
- **성공/실패 상태 전달:** 작업의 성공 여부, 오류 코드, 메시지 등을 포함하여 다음 에이전트가 상황을 판단할 수 있게 합니다.

## 7.3 실패 처리 및 모니터링
여러 에이전트가 연결된 워크플로우는 중간에 실패할 확률이 높습니다. 특정 단계의 실패가 전체 프로세스의 중단으로 이어지지 않도록 견고한 예외 처리 전략이 필수적입니다.

- **실패 처리:** 재시도(Retry), 대체 경로(Fallback), 오류 알림(Alerting) 등 실패 시 행동 방침을 정의합니다.
- **모니터링:** 전체 워크플로우의 성공률, 평균 처리 시간, 비용 등 성능 지표를 추적하고, 각 에이전트의 입/출력 로그를 기록하여 문제를 진단합니다.

---

## 참고 자료
